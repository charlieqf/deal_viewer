# -*- coding: utf-8 -*-
"""
cn-abs.com è¯åˆ¸ä¿¡æ¯çˆ¬å–æµ‹è¯•è„šæœ¬

================================================================================
æŠ“å–æµç¨‹ï¼ˆæ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼‰
================================================================================

æ­¥éª¤1: ç™»å½•
    - æ‰“å¼€ç½‘ç«™: https://www.cn-abs.com/index.html?page=home#/home
    - ä½¿ç”¨è´¦å·ç™»å½•:
        è´¦å·: 18085157187
        å¯†ç : Password01

å¤‡æ³¨ï¼š1. æ‰“å¼€https://www.cn-abs.com/#/home ç‚¹å‡»å³ä¸Šè§’â€œç™»å½•â€æŒ‰é’®ï¼ˆclass="abs-btn btn-logion"ï¼‰ï¼Œæˆ–è€…ç›´æ¥æ‰“å¼€è¿™ä¸ªåœ°å€ï¼šhttps://account.cn-abs.com/account.html?return_url=%2Fconnect%2Fauthorize%2Fcallback%3Fclientid%3Djs_oauth%26client_id%3Djs_oauth%26redirecturi%3Dhttps%253A%252F%252Fwww.cn-abs.com%252Fsign.html%2523%252Fcallback%253F%26redirect_uri%3Dhttps%253A%252F%252Fwww.cn-abs.com%252Fsign.html%2523%252Fcallback%253F%26responsetype%3Did_token%2520token%26response_type%3Did_token%2520token%26scope%3Dopenid%2520profile%2520cnabs%2520quotes%2520organization%2520identity%2520apicenter%2520projects%2520products%2520assets%2520opendata%26state%3D128bdabe45db47b6ab30124c1e2aa336%26nonce%3Dddff580f02534ef79046c942c570b8f3#/login  åº”è¯¥å¯ä»¥ç›´æ¥åˆ°è¾¾ç™»å½•é¡µé¢

é¡µé¢å…ƒç´ ï¼š
ç”¨æˆ·åè¾“å…¥æ¡† class="ant-input ant-input-lg" å’Œå¯†ç è¾“å…¥æ¡† class="ant-input ant-input-lg" éªŒè¯ç  class="abs-captcha-code-img" éªŒè¯ç è¾“å…¥æ¡† class="ant-input ant-input-lg" ç”¨æˆ·åè®®åŒæ„å‹¾é€‰æŒ‰é’® class="ant-checkbox-input" ç™»å½•æŒ‰é’® type="submit" class="ant-btn ant-btn-primary" 

æœ‰ä¸€ä¸ªéªŒè¯ç çš„è¯·æ±‚ï¼š
è¯·æ±‚ç½‘å€: https://account.cn-abs.com/api/global/captcha?type=Login&t=0.9213134580109255
è¯·æ±‚æ–¹æ³•: GET
çŠ¶æ€ä»£ç : 200 OK
è¿œç¨‹åœ°å€: 120.26.229.199:443
å¼•èæ¥æºç½‘å€æ”¿ç­–: strict-origin-when-cross-origin
Connection: keep-alive
Content-Encoding: gzip
Content-Type: image/png
Date: Mon, 08 Dec 2025 04:26:34 GMT
Server: openresty
Set-Cookie: CNABS3_Vcode_Login=8e29aeca-67ff-4cc4-815c-0f176a294b07; path=/; httponly
Transfer-Encoding: chunked
Vary: Accept-Encoding
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: keep-alive
Host: account.cn-abs.com
Referer: https://account.cn-abs.com/account.html?return_url=%2Fconnect%2Fauthorize%2Fcallback%3Fclientid%3Djs_oauth%26client_id%3Djs_oauth%26redirecturi%3Dhttps%253A%252F%252Fwww.cn-abs.com%252Fsign.html%2523%252Fcallback%253F%26redirect_uri%3Dhttps%253A%252F%252Fwww.cn-abs.com%252Fsign.html%2523%252Fcallback%253F%26responsetype%3Did_token%2520token%26response_type%3Did_token%2520token%26scope%3Dopenid%2520profile%2520cnabs%2520quotes%2520organization%2520identity%2520apicenter%2520projects%2520products%2520assets%2520opendata%26state%3Dd5b0af220cc841e3b900d132cc3d2e7a%26nonce%3Ddd7929b70d044748a9625e7f20efb62d
sec-ch-ua: "Not_A Brand";v="99", "Google Chrome";v="109", "Chromium";v="109"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Sec-Fetch-Dest: image
Sec-Fetch-Mode: no-cors
Sec-Fetch-Site: same-origin
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36

è½½è·ï¼š
type: Login
t: 0.45320279503762717
é¢„è§ˆï¼šèƒ½çœ‹åˆ°ä¸€å¼ éªŒè¯ç å›¾ç‰‡

ç‚¹å‡»ç™»å½•æŒ‰é’®åï¼š

è¯·æ±‚ç½‘å€: https://account.cn-abs.com/api/account/login
è¯·æ±‚æ–¹æ³•: POST
çŠ¶æ€ä»£ç : 200 OK
è¿œç¨‹åœ°å€: 120.26.229.199:443
å¼•èæ¥æºç½‘å€æ”¿ç­–: strict-origin-when-cross-origin
Access-Control-Allow-Credentials: true
Access-Control-Allow-Origin: https://account.cn-abs.com
Cache-Control: no-cache,no-store
Connection: keep-alive
Content-Length: 51
Content-Type: application/json; charset=utf-8
Date: Mon, 08 Dec 2025 04:29:22 GMT
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Pragma: no-cache
Server: openresty
Set-Cookie: CNABS3_Vcode_Login=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/
Set-Cookie: idsrv.session=ECBCE737023DCA0DBCA587004110BCFD; path=/; secure
Set-Cookie: .AspNetCore.Identity.Application=CfDJ8B_82XvvshNNn-prPfNHcuXhG3QazWblhBHteUjlMXJlAIVWvweF5nSKlmzIlRwOok4a6IVDC0IZKncve6yEVyKJMV-hk5PFQUJhXhiYH4tb5JmfcVOPsgqIAqPA8EdmBDehHJ0cpaWpF2ff67cq91B9kncxScGucBQ-os3GuqxguwZZxmWZ7l-4DCde2tCIb8cRxShPMYYF6S3K5OHIR9uaigGMyqWujBDtI4q8nrpz-Ts79RowL5pNsVgfcMEaS0j1RhIkzgxcwP05Tjy6eWpT8W6hpAElgzNgbo8WQTsbza2_AAV-71a0sEKn2waz-xLYiSm-80e3dmhmmKgCRNZm0mw84MSIm0vTftrRoB7PhyMGp-HlB86RjOFC7_NpCBvKa7IyWVTSX9S5wummBFFeR3jShB4KOK4UQ3JEVSMH6Mmt4xGLpO5jQSV9k6tUbTAm5WCsM1250bvtzIHaHnMaaZyEEnPpe86kaaktLj9JZefABpsKQJ-TmvL-fuf8LSorQiuLGSYLID-CXijgMQc6aU3ZVX8W0XR9ljwamIdvEKyRrNOOHkr1OZwoL04urUOqSgLBYeVYsNzZ8RabEGL791Vj-TtfQ1jn1POyJsnOSF7JmrXbQyKCn6zHEeBK9ZEFjyv2SB8lwTmH1xvZJN4d_M9iUxWD7whsQO8ZW51GQpZeLv8NFkx_N0sxyiyyqjeHjmL2F0nxOztQ-pbjM8VQ6xOjTBnC0R0SG3RAFxKtLYaw9N3yAxjnH7PuGHGQDnO8kDlgPSHxpLNlCXvj3anUS-sP7zDHHrXp-lQHZzVlo-UmxfHAHaQZYM_JgmBB_H-PBssOEgD-JXxkv84r3rkSWaASt-l2oZFPNJcuwo6YFHOcAyefeG7SZdw1DiA8MRWliOqgl8ovQuqXq_EXt3VryTr3F2kRhP4qFu2nW0Sw5VwxUcW7OBvDVyxAiImslLscftQUebxKTAg5y-S6I90M4KTarpjnyOWmrfV7QVCk-g2x5B8pT05C4eAY65VXER-w2-eDs6FsMnJg3bwgjM62f7X40_F_FCbRpFpzJIF3TjtqojkZLWXTZgJFG6zn49YeIO_c6B0roRuKKAWPQ9YKJqZwHBYjt5Lc3HiVuGf1hON3cx91gNo0gwNTCjy05SXh8wGVFGt08tSaAMZdL2QqbyX9h_YnYAudsI8OhFszZk3_lFAgSolIUAIH65Ro4w; path=/; secure; httponly
Vary: Origin
Accept: application/json
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: keep-alive
Content-Length: 68
Content-Type: application/json
Cookie: CNABS3_Vcode_Login=1832b9a2-5f27-4a54-ac91-f2b17a2241cc
Host: account.cn-abs.com
Origin: https://account.cn-abs.com
Referer: https://account.cn-abs.com/account.html?return_url=%2Fconnect%2Fauthorize%2Fcallback%3Fclientid%3Djs_oauth%26client_id%3Djs_oauth%26redirecturi%3Dhttps%253A%252F%252Fwww.cn-abs.com%252Fsign.html%2523%252Fcallback%253F%26redirect_uri%3Dhttps%253A%252F%252Fwww.cn-abs.com%252Fsign.html%2523%252Fcallback%253F%26responsetype%3Did_token%2520token%26response_type%3Did_token%2520token%26scope%3Dopenid%2520profile%2520cnabs%2520quotes%2520organization%2520identity%2520apicenter%2520projects%2520products%2520assets%2520opendata%26state%3D2bddd322da43424fb2adebd011c3f783%26nonce%3D4c7fc75cccd344dbb3f1ccbaac8f4281
sec-ch-ua: "Not_A Brand";v="99", "Google Chrome";v="109", "Chromium";v="109"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Title: %E8%B5%84%E4%BA%A7%E8%AF%81%E5%88%B8%E5%8C%96%E5%88%86%E6%9E%90%E7%BD%91-ABS%E3%80%81REITs%E5%9C%A8%E7%BA%BF%E5%88%86%E6%9E%90%E5%B9%B3%E5%8F%B0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36

è½½è·ï¼š
{user_name: "13985684486", password: "88520123Ww", captcha: "6017"}
captcha: "6017"
password: "88520123Ww"
user_name: "13985684486"

å“åº”ï¼šæ— æ³•åŠ è½½å“åº”æ•°æ®: No resource with given identifier found

loginè¯·æ±‚ä¹‹åæœ‰ä¸€ä¸ªcallbackè¯·æ±‚ï¼š
è¯·æ±‚ç½‘å€: https://account.cn-abs.com/connect/authorize/callback?clientid=js_oauth&client_id=js_oauth&redirecturi=https%3A%2F%2Fwww.cn-abs.com%2Fsign.html%23%2Fcallback%3F&redirect_uri=https%3A%2F%2Fwww.cn-abs.com%2Fsign.html%23%2Fcallback%3F&responsetype=id_token%20token&response_type=id_token%20token&scope=openid%20profile%20cnabs%20quotes%20organization%20identity%20apicenter%20projects%20products%20assets%20opendata&state=2bddd322da43424fb2adebd011c3f783&nonce=4c7fc75cccd344dbb3f1ccbaac8f4281
è¯·æ±‚æ–¹æ³•: GET
çŠ¶æ€ä»£ç : 302 Found
è¿œç¨‹åœ°å€: 120.26.229.199:443
å¼•èæ¥æºç½‘å€æ”¿ç­–: strict-origin-when-cross-origin
Cache-Control: no-store, no-cache, max-age=0
Connection: keep-alive
Date: Mon, 08 Dec 2025 04:29:22 GMT
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Location: https://www.cn-abs.com/sign.html#/callback?id_token=eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc2NTkyRTczMTFGMjRFMjg4QjVCQ0Q4QTU1RjU2QTg2MzFFOUNBQTNSUzI1NiIsInR5cCI6IkpXVCIsIng1dCI6ImRsa3VjeEh5VGlpTFc4MktWZlZxaGpIcHlxTSJ9.eyJuYmYiOjE3NjUxNjgxNjIsImV4cCI6MTc2NTE2ODQ2MiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50LmNuLWFicy5jb20iLCJhdWQiOiJqc19vYXV0aCIsIm5vbmNlIjoiNGM3ZmM3NWNjY2QzNDRkYmIzZjFjY2JhYWM4ZjQyODEiLCJpYXQiOjE3NjUxNjgxNjIsImF0X2hhc2giOiJ6Y1RnVHAtd0tVZjB1cUFWREJLZVNRIiwic19oYXNoIjoiSjR5bVpNZ2JNVDVDUHBxWTh5TmhYZyIsInNpZCI6IkVDQkNFNzM3MDIzRENBMERCQ0E1ODcwMDQxMTBCQ0ZEIiwic3ViIjoiQ0M2QzdBNEUtMzA3My00NjM4LThGQkYtRUIyQjEwMDg4NEJDIiwiYXV0aF90aW1lIjoxNzY1MTY4MTYyLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.crkAu4S8pCz2VSl4UeTkk0cH_LnuuSj32NWzAq6jEOrcF1QR-iJ8f1mwMr0aOT_Sl0Jo9nsvxiUNjdePdqC9AhcWG9fljYV7pjZJj8geN2o7esgjTGraecky_TJuwhfWbQvsckylFUWbz82q8kYA-1nHqC5Lj4FCG5XOFiPwzhsQyZBwTRgD8jji0_aQlG_oJcAs1mLk5Y8pZZrsF2nZEvhYg6Jf2SfNrghtIsK4ZGuX1VowJo6_sWDz6wx7-h1G8fa1gJtwHbTZaHgkTmFGp_AwcIYE6cQGUviwh0xj39ol9cYpQr7n9PvXbnJoh_mlmdNsKMWyB_y0J8U_q5Zqjqvf-Il-sfTMrjNW14AxtYR7gcbHL3HhZLsI_xcnEsAkLC2uzlXx-uvc_TfNGpwcV6CzOUhMwJfTWyU7VFAPL6RXwDEJVqVOAYGS9tES6JfV62sFK5YyyZBTgL1nQN3HQ3DxYz3hFl4-tJc6-xVxPKWMAm18-wnWchOaVQCXa-7LtXTzUJ4ubWbKLpAyVvdSCjiZIBBdZfaRfYSPQC96Nwny3SDV4RiMZXpgoA76LGLed01b9_1cSrAJkep5CbUEUjmF5XycVbBf1rOAclt4wLIh4rM9Dc82j8wAmW3nFungvo3Sf1UfLRKiC7HLU7ESE_eeJki1UNjmNJx6pGHgXSQ&access_token=eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc2NTkyRTczMTFGMjRFMjg4QjVCQ0Q4QTU1RjU2QTg2MzFFOUNBQTNSUzI1NiIsInR5cCI6ImF0K2p3dCIsIng1dCI6ImRsa3VjeEh5VGlpTFc4MktWZlZxaGpIcHlxTSJ9.eyJuYmYiOjE3NjUxNjgxNjIsImV4cCI6MTc2NTI1NDU2MiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50LmNuLWFicy5jb20iLCJhdWQiOlsiY25hYnMiLCJwcm9kdWN0cyIsImNhbGMiLCJxdW90ZXMiLCJvcmdhbml6YXRpb24iLCJpZGVudGl0eSIsImFwaWNlbnRlciIsInByb2plY3RzIiwiYXNzZXRzIiwib3BlbmRhdGEiXSwiY2xpZW50X2lkIjoianNfb2F1dGgiLCJzdWIiOiJDQzZDN0E0RS0zMDczLTQ2MzgtOEZCRi1FQjJCMTAwODg0QkMiLCJhdXRoX3RpbWUiOjE3NjUxNjgxNjIsImlkcCI6ImxvY2FsIiwibmFtZSI6IjEzOTg1Njg0NDg2Iiwic2lkIjoiRUNCQ0U3MzcwMjNEQ0EwREJDQTU4NzAwNDExMEJDRkQiLCJpYXQiOjE3NjUxNjgxNjIsInNjb3BlIjpbIm9wZW5pZCIsInByb2ZpbGUiLCJjbmFicyIsInF1b3RlcyIsIm9yZ2FuaXphdGlvbiIsImlkZW50aXR5IiwiYXBpY2VudGVyIiwicHJvamVjdHMiLCJwcm9kdWN0cyIsImFzc2V0cyIsIm9wZW5kYXRhIl0sImFtciI6WyJwd2QiXX0.D9t_cUhnWODhn38Dhns13K-1MHDtjgi02bVgxnoC2rcLdkTIkiMC2VYDPUVeg075ru1PzPBT76Nsby5TodpRXDPRzPNqHAchXLM5Z_Vc6vWonh9DQckbX6tngS737M0jyQTwj_kxC3YtwGBCqBkAZO4Mk7rS5O5pqJg2vOPCZqvG1-IheI7QFW5hULYCgMXEeEGVWo_n4oT0zbX6Iej6MxZnGttqzVieVSwSibl8wyc6qgZpY2bmKHRjBvdvu92NBose5rXO_0w7BDRdhYHMHc_oP7oo-JdOWwRiWH-pYiqxOGxlf_IDPIEzFf4FGjAj5xpp7ZqxV6ISRHJKMA0_x_AEFVnot4RfuIEtTKwjWr-8pnLaYaa_9Hu_YyPdMazQC88OjjzCcsyhpVfymkN32xCv1v9P0VhWwrKRD5dhg-B5VH3n_qpf3QHaMuF-Q6MCn1ujKL2jZpiCKoRMYMkEZ4th3frnUacV5tbK7Gcok60ttSOsYnOmViWCPZrxU6JJByFSIXi45hspoZzQxND9PpRoqRAjv6bU4m87Q0tFZDPZyw42WICagMgeXZ6r9GP_RZKLjmHw8JL5Dx5br9JwgLtnm94Fp5nqFcd5otLhMIDfnxcq24SBGTPhYTJF1n_OeYnSpfVPIkLS5OogvEiWANyH151ULtT2gnkek4ZzOtQ&token_type=Bearer&expires_in=86400&scope=openid%20profile%20cnabs%20quotes%20organization%20identity%20apicenter%20projects%20products%20assets%20opendata&state=2bddd322da43424fb2adebd011c3f783&session_state=wIO5N6zNT4JEZBp4hR360AGdaPDyRdSkaiiK67jmx9I.88F075C3B86E5FC3BE2B663DCB856AA0
Pragma: no-cache
Server: openresty
Set-Cookie: .AspNetCore.Identity.Application=CfDJ8B_82XvvshNNn-prPfNHcuUf3-QNKb3JZ85dDP61RGbjXVnUopQoh0EEOz4De2hhpzbFgLl9jeOmNPs4A0iy8SCdc86x09Gd5OhOmys8mU5ljYmTdaoHKLnoRm38fA8-s8nN3F4RAEnGQzfqOp8pqUpuvV-0mswOTcYkE-GK-Ms476x19bAaeI4R43ivxyXqPgVgER60VhO0rgsROxowefMaeWggUMqNiwDBjrmgnpbX2fTnE4yRtY0I3fj2xjTHDJv6BrjL3l0M3FYNcDqMQ0WXyS-HP5J0jUkEkbUB793NhGcTJr0Pfw8cV8lZpYA1htJLAnKrdIDfxAoAf7oBZQ2M0qRdWMrDFS0JVPT6QYvFYLlohd8GY7m0Oz8NtF-n-rFEdqc3ChcEHf_8euPhzc27HCKefeALLlDA1C1Qx1r-4Y4_sxGFzbYbaGhOHVZvkvxTliR7Ln4pCPIIWn8YhfHBMXkrTUfFQU9MKk_wjy_zMi4OfHK4aDocfzvtAVf6sw4tpS7g_HhlwomkCFNKiCnFozu03oEL1p5a934XIyKcLphRDSebD750Op_43ChZ8Br4hgZdixEx7XWUwMd31yWd7xeuYfaaLDWRgcOv-EuDm0d2hfEtzXtMJUQ8eUGY2J89271fdbcl9CeFnnXg8oVCfPr5UEL0Tl5nClzHvOkwao6sM8J72NL0jnNBj_wlkfuk1iz9c0cgn9Gu2GtcFK072d07kReHLTEJDnfh4CAubiT7l-OqCRVTcQ54HnusNHVe8keIfGeMxn3c9KvvkeNGNOh63QownJYzar4nMChuvhfCDF72EzNaMsWx8C4x3zf5nbwinU4Ec3gDxlAYI0hiOfdrjLIgPZ66_x4XEVJoeGb-U8-KEfpc4rE29Bfnc8NKWtnEM7ddddf5z2TZxjw1eMEqGZossCuYwTrYB4EHUu2hP1WKpXtYURptyMV_A_onxZ6ii2YT6SZYWsWc_wl9jEUd0j2sFcNgKjlUTJ1u6XjDg8gUPGrwMOSsfi-iOgB9qyC58akQaMPoczVTu9_M_Mx53Yo9z4siOMTdkKScrj5GPyQYoNAQ0Z7aC9XIMatv60dC0s_5hmOO9FWJk4pb82oPdIh7SeD3GLAxOl4nLch9SZS9cFE-dc3CbplrxDCG8Eo2njWb5VCyjWNrSVeR78pwA_c3iSuHnKbQe4zdHOmfW7IvwiFFDPBRMgBgg9XRrZkByj7A4LDVNP05FYA; path=/; secure; httponly
Transfer-Encoding: chunked

å“åº”ï¼šæ— æ³•åŠ è½½å“åº”æ•°æ®


è¯·æ±‚ç½‘å€: https://www.cn-abs.com/apigateway/cnabs/account/login/oauth
è¯·æ±‚æ–¹æ³•: POST
çŠ¶æ€ä»£ç : 200 OK

Access-Control-Allow-Credentials: true
Access-Control-Allow-Headers: *
Access-Control-Allow-Methods: GET, POST, PUT, DELETE
Access-Control-Allow-Origin: *
Cache-Control: private, s-maxage=0
Connection: keep-alive
Content-Length: 255
Content-Type: text/html; charset=utf-8
Date: Mon, 08 Dec 2025 05:37:31 GMT
Expires: -1
Pragma: no-cache
Server: openresty
Set-Cookie: CNABS_PassCode=13985684486; domain=cn-abs.com; expires=Mon, 15-Dec-2025 05:37:25 GMT; path=/
Set-Cookie: cnabs=2B0C37A02606A7F3FCA3205E2B2696D84B65779B42C4A679B862F6AA229E14A66058E551FE5DCB69C755C682ED41BB6B241DE6D9DACD7912CF9555A88A8F6EECC052B646CDB3446EF170796799A5B1DF04401246; domain=cn-abs.com; expires=Mon, 15-Dec-2025 05:37:30 GMT; path=/; HttpOnly; SameSite=Lax
Set-Cookie: ISNEW=; expires=Sun, 07-Dec-2025 05:37:31 GMT; path=/
Set-Cookie: cnabs_web=LW3rgXGydKHCUGia4258h3o1CPq1WXG2hoZii-btahMm23k6x2jcvz3pM7a5war-I6PbtWxKtUu2CRbjpL5DhxcCfg75wUEVQUx8N28c1sfxFpheSyoxImIkxMXUmjojY6zKN83DOdOBoI_0DA_OnVKe5b00G1ekLT7tbeFnpha-MhwG52KQ8fOe8j_5B6gpB6Tl1mw-OKie3ja51-uzpV6g58pBuLiNQlQxXQ0ADVLxlSI2CJjfSl4S9KNWbGbIWhQZYelaCsggG-aZed7Pe16SkL4Q2LKGw15xYWxqfG7nwpY21jt03AkCLIefgiUg5rkUrUNx0n7-eFPnwnllqth8sJQ; domain=cn-abs.com; path=/; HttpOnly
X-AspNet-Version: 4.0.30319
X-AspNetMvc-Version: 5.2

Accept: application/json
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc2NTkyRTczMTFGMjRFMjg4QjVCQ0Q4QTU1RjU2QTg2MzFFOUNBQTNSUzI1NiIsInR5cCI6ImF0K2p3dCIsIng1dCI6ImRsa3VjeEh5VGlpTFc4MktWZlZxaGpIcHlxTSJ9.eyJuYmYiOjE3NjUxNzIyNDksImV4cCI6MTc2NTI1ODY0OSwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50LmNuLWFicy5jb20iLCJhdWQiOlsiY25hYnMiLCJwcm9kdWN0cyIsImNhbGMiLCJxdW90ZXMiLCJvcmdhbml6YXRpb24iLCJpZGVudGl0eSIsImFwaWNlbnRlciIsInByb2plY3RzIiwiYXNzZXRzIiwib3BlbmRhdGEiXSwiY2xpZW50X2lkIjoianNfb2F1dGgiLCJzdWIiOiJDQzZDN0E0RS0zMDczLTQ2MzgtOEZCRi1FQjJCMTAwODg0QkMiLCJhdXRoX3RpbWUiOjE3NjUxNzIyNDksImlkcCI6ImxvY2FsIiwibmFtZSI6IjEzOTg1Njg0NDg2Iiwic2lkIjoiRUU1M0JGM0ZBOTU0NEZCMzI2ODY3MjUyQkNGQkUxMzEiLCJpYXQiOjE3NjUxNzIyNDksInNjb3BlIjpbIm9wZW5pZCIsInByb2ZpbGUiLCJjbmFicyIsInF1b3RlcyIsIm9yZ2FuaXphdGlvbiIsImlkZW50aXR5IiwiYXBpY2VudGVyIiwicHJvamVjdHMiLCJwcm9kdWN0cyIsImFzc2V0cyIsIm9wZW5kYXRhIl0sImFtciI6WyJwd2QiXX0.KL9kHFF1xm5UZ8NlnjcdFB5PCiabHVVWxjHqKvmS3vePKx2MhST5z05EuxM8UOFrf4JpuD9EC978UIxXXoMNx2ioju6muLWctd8xjH5zCXt5voRTsNKbQ6BbyN86qS4jpUR5eOvfpZKsxgWTEBSpv7heCRiZn98O7yv4N3t8bP2dkwPJ3bpOoZ7hUCF8iSplzpEIDlFGC3nQwZgaz_6GYvhYXAlc245RbqBdbaglw6jhYgQTv58LyT5ahJ-FLaXVbn4NG860wPnjxTCP0me8AJiL8edPBifYBR4UvCTpxjcHmNrYY92P4Mc7bikHDQde4p5cAgmaqz47reH-04jBikwKt0Bhvtcz2NzlFRs8qNpgwH3DhFFOPacuO78G5Mb8Ou5gZ6P4AtKOopEPwbI42H_R5bnmiN4Va4TpTIK4xmu0JtFmy24X6o5IqX-sofQ06-2_SB4ddon2jEQh93eY8GXmzJzZgMgN3wrGPqabLCulCg-u6J5-U4NH3KKcg5z4ladyU70J-C-P42tFeSq7fFK0x-wTnX-BWVW-UVdFDJEbQ7xwLugri6U86FYBVGLR5VzI0qaGG29DH_7CtRAgMS29-KZXit4TWrcJaVOdC24R1HMrtSWJqOqKUMi6HiWrhVqL4IgLacLbPG8_qIv1zADWHVR3jdpFfEeys01RB1I
Connection: keep-alive
Content-Length: 0
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Cookie: CNABS_PassCode=13985684486
Host: www.cn-abs.com
Origin: https://www.cn-abs.com
Referer: https://www.cn-abs.com/sign.html
sec-ch-ua: "Not_A Brand";v="99", "Google Chrome";v="109", "Chromium";v="109"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Title: %E8%B5%84%E4%BA%A7%E8%AF%81%E5%88%B8%E5%8C%96%E5%88%86%E6%9E%90%E7%BD%91-ABS%E3%80%81REITs%E5%9C%A8%E7%BA%BF%E5%88%86%E6%9E%90%E5%B9%B3%E5%8F%B0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36

æ­¥éª¤2: æœç´¢äº§å“
    - æ‰¾åˆ°é¡µé¢å³ä¸Šè§’çš„æœç´¢æ¡†ï¼ˆtype="text" class="ant-input" ï¼‰
    - è¾“å…¥äº§å“åç§°ï¼Œä¾‹å¦‚: "æ·±åœ³å¼—è¿ªèèµ„ç§Ÿèµæœ‰é™å…¬å¸2025å¹´åº¦ç¬¬ä¸€æœŸç»¿è‰²èµ„äº§æ”¯æŒç¥¨æ®"
    - å›è½¦

å›è½¦æ—¶åœ¨F12 Networkä¸­çœ‹åˆ°çš„è¯·æ±‚ï¼š
1. check
è¯·æ±‚ç½‘å€: https://www.cn-abs.com/apigateway/cnabs/account/invite/business/check?url=%2Findex.html%2F%23%2Fmain%2Fsearch%3Fkeyword%3D%25E6%25B7%25B1%25E5%259C%25B3%25E5%25BC%2597%25E8%25BF%25AA%25E8%259E%258D%25E8%25B5%2584%25E7%25A7%259F%25E8%25B5%2581%25E6%259C%2589%25E9%2599%2590%25E5%2585%25AC%25E5%258F%25B82025%25E5%25B9%25B4%25E5%25BA%25A6%25E7%25AC%25AC%25E4%25B8%2580%25E6%259C%259F%25E7%25BB%25BF%25E8%2589%25B2%25E8%25B5%2584%25E4%25BA%25A7%25E6%2594%25AF%25E6%258C%2581%25E7%25A5%25A8%25E6%258D%25AE&title=%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C
è¯·æ±‚æ–¹æ³•: POST
çŠ¶æ€ä»£ç : 200 OK

2. count
è¯·æ±‚ç½‘å€: https://www.cn-abs.com/apigateway/cnabs/account/internal-message/unread/count
è¯·æ±‚æ–¹æ³•: POST

3. popup
è¯·æ±‚ç½‘å€: https://www.cn-abs.com/apigateway/cnabs/account/invite/popup
è¯·æ±‚æ–¹æ³•: POST

4. pager
è¯·æ±‚ç½‘å€: https://www.cn-abs.com/apigateway/cnabs/global/search/pager
è¯·æ±‚æ–¹æ³•: POST
çŠ¶æ€ä»£ç : 200 OK
è¿œç¨‹åœ°å€: 120.26.229.199:443
å¼•èæ¥æºç½‘å€æ”¿ç­–: strict-origin-when-cross-origin
Access-Control-Allow-Credentials: true
Access-Control-Allow-Headers: DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization,title
Access-Control-Allow-Methods: POST
Access-Control-Allow-Origin: https://www.cn-abs.com
Connection: keep-alive
Content-Length: 1489
Content-Type: application/json; charset=utf-8
Date: Mon, 08 Dec 2025 03:39:50 GMT
Server: openresty
Vary: Origin

è¯·æ±‚æ ‡å¤´ï¼š
Accept: application/json
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc2NTkyRTczMTFGMjRFMjg4QjVCQ0Q4QTU1RjU2QTg2MzFFOUNBQTNSUzI1NiIsInR5cCI6ImF0K2p3dCIsIng1dCI6ImRsa3VjeEh5VGlpTFc4MktWZlZxaGpIcHlxTSJ9.eyJuYmYiOjE3NjUxNzA2NDIsImV4cCI6MTc2NTI1NzA0MiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50LmNuLWFicy5jb20iLCJhdWQiOlsiY25hYnMiLCJwcm9kdWN0cyIsImNhbGMiLCJxdW90ZXMiLCJvcmdhbml6YXRpb24iLCJpZGVudGl0eSIsImFwaWNlbnRlciIsInByb2plY3RzIiwiYXNzZXRzIiwib3BlbmRhdGEiXSwiY2xpZW50X2lkIjoianNfb2F1dGgiLCJzdWIiOiJDQzZDN0E0RS0zMDczLTQ2MzgtOEZCRi1FQjJCMTAwODg0QkMiLCJhdXRoX3RpbWUiOjE3NjUxNzA2MzEsImlkcCI6ImxvY2FsIiwibmFtZSI6IjEzOTg1Njg0NDg2Iiwic2lkIjoiN0ZFODVGQTc0MEU2Q0Q5MTY2MDI4NkRDM0E1MUM3N0EiLCJpYXQiOjE3NjUxNzA2NDIsInNjb3BlIjpbIm9wZW5pZCIsInByb2ZpbGUiLCJjbmFicyIsInF1b3RlcyIsIm9yZ2FuaXphdGlvbiIsImlkZW50aXR5IiwiYXBpY2VudGVyIiwicHJvamVjdHMiLCJwcm9kdWN0cyIsImFzc2V0cyIsIm9wZW5kYXRhIl0sImFtciI6WyJwd2QiXX0.Ayf1hF4bnjukafLLj8uuPxVKwdGnh38embUwne-KpgWJh9Cbp6LtogsMHhpah28C1q31DJ10fO3obxYVMQaGnPKPG3GrRfVOTxw_zkt98fexzGgUALLPAZVtBKV1zCz5Qu3UJx6v4wbFVGxzxgu8XLtS3Wt0HzJs8IDcYN9Guloeo2WZ3C6S69W0uLW5tDlkuC7sIj16uxIMcU2U_9RYv9_yM6yuxDQCVGw-uqa-yQlGiVIemfMrBHJfekFkNeG1XMs9AH9z-7Afd0c0JNTI3LPYHX9DjKA9aPRaEwcIygdQpAzVPuLi5CZihdRL4eJa-aelGm30tiD4-HK4rQRPENh8K4fhWv4cIVKZqxhKtfO_AuVQtaHEHD05SS3i-kkNbz7Dfg4yeB63KeHRs89kYXj8DJmXKtCxiMyP7L7NsLPwFWaR3wxVbAiUfEo6yyDBHhjf0T_0rpg45sGtbAdHPeC2I1npTPNkKhdEmziVw67Z049KciN2-9PKiLmqu-3eGSUnR3hNm8yPuOgY_oVNQyZ9yTqXZ1mTrI2jk-aNjb4s7LGpWasy7FbVE7paGP4_ABkrv2kNJjRjjnpviWtSUD2X-xa8NtuZPo_fffanIU0Ios3STsui2Emupu28pYshDXG-e2aNmnTSERsDFlwhHc4i1Zw9NbuS-Rz2vFBP4pY
Connection: keep-alive
Content-Length: 316
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Cookie: CNABS_PassCode=13985684486; CNABS_PassCode=13985684486; cnabs=C705C3B4DA4CD916B751F47A68621B4B73563ACA71FC49A70E34971E8456555C67F7D1A2B456A75665ABC0F663B76E440E93F476E08BDB1B5FB2514C86107726DFECA6D8DFBCAB31389360643139063F610610F1; cnabs_web=SgS6RPVPU3UNPt6_EEz9S9HzfyPsXVrUW82Gr4GDznJpiqs-qCwYJE_xN7A3j-5unlL5DBhk-8KGvaf01yNoNwEHyj6TLTekZdf-SdsChQN98Rd2bPhVHnMxRgolaRz9ij5plFRTcU9LZPDERi6eyPRt1GmNo64HgsDg5Dnu5dOfpl9FjU7Gj-2hBs29-7l2hY96V-p66olqPJAJnL_C4eYvvaPHljAqHZyfFACXZeSd33oVyd9Ufos0jnRNRENA2jeDcTF4sYI26W29V7VFPlJTmdcVB43zt_tieAZzwcZ4q91fvXFfj1kv9A5AWNNjbHKpc1hodVftskiHnqoY1kfBT3c
Host: www.cn-abs.com
Origin: https://www.cn-abs.com
Referer: https://www.cn-abs.com/index.html
sec-ch-ua: "Not_A Brand";v="99", "Google Chrome";v="109", "Chromium";v="109"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Title: %E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36

è½½è·ï¼š
keyword: æ·±åœ³å¼—è¿ªèèµ„ç§Ÿèµæœ‰é™å…¬å¸2025å¹´åº¦ç¬¬ä¸€æœŸç»¿è‰²èµ„äº§æ”¯æŒç¥¨æ®
search_type: 0
timestamp: 2025-12-08T03:39:38.849Z
page_index: 1
page_size: 30

å“åº”ï¼š
{"code":200,"data":{"OrganizationPager":{"page_size":30,"current_page":1,"total_pages":0,"total_items":0,"items":[]},"DealPager":{"page_size":30,"current_page":1,"total_pages":1,"total_items":1,"items":[{"id":21363,"short_name":"å¼—è¿ªABN2025-1","full_name":"æ·±åœ³å¼—è¿ªèèµ„ç§Ÿèµæœ‰é™å…¬å¸2025å¹´åº¦ç¬¬ä¸€æœŸç»¿è‰²èµ„äº§æ”¯æŒç¥¨æ®","deal_type":"èèµ„ç§Ÿèµ","total_offering":6784000000.0,"originators":null,"url":"?deal_id=21363"}]},"SecurityPager":{"page_size":30,"current_page":1,"total_pages":1,"total_items":2,"items":[{"id":56474,"code":"082580900.IB","short_name":"25å¼—è¿ªç§ŸèµABN001æ¬¡çº§(ç»¿è‰²)","security_type":"æ¬¡çº§","expected_maturity_date":"2030-07-12","deal_short_name":"å¼—è¿ªABN2025-1","deal_full_name":"æ·±åœ³å¼—è¿ªèèµ„ç§Ÿèµæœ‰é™å…¬å¸2025å¹´åº¦ç¬¬ä¸€æœŸç»¿è‰²èµ„äº§æ”¯æŒç¥¨æ®","product_type":"èµ„äº§æ”¯æŒç¥¨æ®","current_coupon":0.04,"current_rating":"NR","wal":4.5942922374429225,"url":"?security_id=56474"},{"id":56473,"code":"082580899.IB","short_name":"25å¼—è¿ªç§ŸèµABN001ä¼˜å…ˆ(ç»¿è‰²)","security_type":"ä¼˜å…ˆçº§","expected_maturity_date":"2028-07-14","deal_short_name":"å¼—è¿ªABN2025-1","deal_full_name":"æ·±åœ³å¼—è¿ªèèµ„ç§Ÿèµæœ‰é™å…¬å¸2025å¹´åº¦ç¬¬ä¸€æœŸç»¿è‰²èµ„äº§æ”¯æŒç¥¨æ®","product_type":"èµ„äº§æ”¯æŒç¥¨æ®","current_coupon":0.017,"current_rating":"AAA","wal":2.599771689497717,"url":"?security_id=56473"}]},"ExpertPager":{"page_size":30,"current_page":1,"total_pages":0,"total_items":0,"items":[]}},"message":null,"status":"ok"}

** æ³¨æ„ï¼šä»¥ä¸Š4ä¸ªè¯·æ±‚çš„è¯·æ±‚æ ‡å¤´ä¸­éƒ½æœ‰Authorizationå’ŒCookieï¼š
Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc2NTkyRTczMTFGMjRFMjg4QjVCQ0Q4QTU1RjU2QTg2MzFFOUNBQTNSUzI1NiIsInR5cCI6ImF0K2p3dCIsIng1dCI6ImRsa3VjeEh5VGlpTFc4MktWZlZxaGpIcHlxTSJ9.eyJuYmYiOjE3NjUxNjgxNjIsImV4cCI6MTc2NTI1NDU2MiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50LmNuLWFicy5jb20iLCJhdWQiOlsiY25hYnMiLCJwcm9kdWN0cyIsImNhbGMiLCJxdW90ZXMiLCJvcmdhbml6YXRpb24iLCJpZGVudGl0eSIsImFwaWNlbnRlciIsInByb2plY3RzIiwiYXNzZXRzIiwib3BlbmRhdGEiXSwiY2xpZW50X2lkIjoianNfb2F1dGgiLCJzdWIiOiJDQzZDN0E0RS0zMDczLTQ2MzgtOEZCRi1FQjJCMTAwODg0QkMiLCJhdXRoX3RpbWUiOjE3NjUxNjgxNjIsImlkcCI6ImxvY2FsIiwibmFtZSI6IjEzOTg1Njg0NDg2Iiwic2lkIjoiRUNCQ0U3MzcwMjNEQ0EwREJDQTU4NzAwNDExMEJDRkQiLCJpYXQiOjE3NjUxNjgxNjIsInNjb3BlIjpbIm9wZW5pZCIsInByb2ZpbGUiLCJjbmFicyIsInF1b3RlcyIsIm9yZ2FuaXphdGlvbiIsImlkZW50aXR5IiwiYXBpY2VudGVyIiwicHJvamVjdHMiLCJwcm9kdWN0cyIsImFzc2V0cyIsIm9wZW5kYXRhIl0sImFtciI6WyJwd2QiXX0.D9t_cUhnWODhn38Dhns13K-1MHDtjgi02bVgxnoC2rcLdkTIkiMC2VYDPUVeg075ru1PzPBT76Nsby5TodpRXDPRzPNqHAchXLM5Z_Vc6vWonh9DQckbX6tngS737M0jyQTwj_kxC3YtwGBCqBkAZO4Mk7rS5O5pqJg2vOPCZqvG1-IheI7QFW5hULYCgMXEeEGVWo_n4oT0zbX6Iej6MxZnGttqzVieVSwSibl8wyc6qgZpY2bmKHRjBvdvu92NBose5rXO_0w7BDRdhYHMHc_oP7oo-JdOWwRiWH-pYiqxOGxlf_IDPIEzFf4FGjAj5xpp7ZqxV6ISRHJKMA0_x_AEFVnot4RfuIEtTKwjWr-8pnLaYaa_9Hu_YyPdMazQC88OjjzCcsyhpVfymkN32xCv1v9P0VhWwrKRD5dhg-B5VH3n_qpf3QHaMuF-Q6MCn1ujKL2jZpiCKoRMYMkEZ4th3frnUacV5tbK7Gcok60ttSOsYnOmViWCPZrxU6JJByFSIXi45hspoZzQxND9PpRoqRAjv6bU4m87Q0tFZDPZyw42WICagMgeXZ6r9GP_RZKLjmHw8JL5Dx5br9JwgLtnm94Fp5nqFcd5otLhMIDfnxcq24SBGTPhYTJF1n_OeYnSpfVPIkLS5OogvEiWANyH151ULtT2gnkek4ZzOtQ

Cookie: CNABS_PassCode=13985684486; CNABS_PassCode=13985684486; cnabs=91F249F56B315DB31B43730D95BDF97C13F589D86E4B9FF49C60E55192AB7D89C0A83CF996C0FB1C678D38D54427644CA1D468EC0EDE9CC313E9DD65AEF10703B8CF481AAF97417DEAABD090AA61E03F23CAA2FA; cnabs_web=9weJBxdxUxW9rodsc5B5I3iQFl1hsulYLJMGxCwshKTLAnapoPhxsslyxJ5THBh3jsUS6zcKyB91egYgzkO4PuN0KFM3XTKAhIxqk9darxdEKgXnhZgfgwMKrF8aXN5w6ZTOtktRHtFnKGegu--NQHgRbjlD9a5R8E-vFcRqhQcSYV7bCoRJORNf16_32Dz9xzLUul8KTIL3FdIo7SSgHBqFI7kKtGPAH1adgpW0iP0CdSTPsxzdDx5J2WxRRyZ3E-vOJ5DxrWWeu2_OxQSizYunuuQDud1PHXqWTpJVLLRsxkvw4b1si5fFtlTxP_RV6KYERa8JIOc6xOitVur2VozBQzQ


æ­¥éª¤3: è¿›å…¥äº§å“é¡µé¢
    - åœ¨æœç´¢ç»“æœé¡µé¢ï¼Œæ‰¾åˆ°"äº§å“"æ ç›®
    - ç‚¹å‡»ç¬¬ä¸€æ¡"äº§å“å…¨ç§°"ç»“æœï¼Œè¿›å…¥äº§å“è¯¦æƒ…é¡µé¢

å¤‡æ³¨ï¼š
ç‚¹å‡»äº§å“å…¨ç§°æ—¶ï¼Œæˆ‘è§‚å¯Ÿåˆ°ä¸¤ä¸ªè¯·æ±‚ï¼š

1. è¯·æ±‚ç½‘å€: https://www.cn-abs.com/apigateway/cnabs/account/invite/business/check?url=%2Fproduct.html%2F%23%2Fdetail%2Fsecurity%3Fdeal_id%3D21363&title=%E4%BA%A7%E5%93%81%E8%AF%81%E5%88%B8
è¯·æ±‚æ–¹æ³•: POST
è½½è·ï¼š
url: /product.html/#/detail/security?deal_id=21363
title: äº§å“è¯åˆ¸


2. è¯·æ±‚ç½‘å€: https://www.cn-abs.com/apigateway/cnabs/deal/security-detail?deal_id=21363&page_index=1
è¯·æ±‚æ–¹æ³•: POST
è½½è·ï¼š
deal_id: 21363
page_index: 1

è¯·æ±‚æ ‡å¤´ï¼š
Accept: application/json
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc2NTkyRTczMTFGMjRFMjg4QjVCQ0Q4QTU1RjU2QTg2MzFFOUNBQTNSUzI1NiIsInR5cCI6ImF0K2p3dCIsIng1dCI6ImRsa3VjeEh5VGlpTFc4MktWZlZxaGpIcHlxTSJ9.eyJuYmYiOjE3NjUxNzA2NDIsImV4cCI6MTc2NTI1NzA0MiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50LmNuLWFicy5jb20iLCJhdWQiOlsiY25hYnMiLCJwcm9kdWN0cyIsImNhbGMiLCJxdW90ZXMiLCJvcmdhbml6YXRpb24iLCJpZGVudGl0eSIsImFwaWNlbnRlciIsInByb2plY3RzIiwiYXNzZXRzIiwib3BlbmRhdGEiXSwiY2xpZW50X2lkIjoianNfb2F1dGgiLCJzdWIiOiJDQzZDN0E0RS0zMDczLTQ2MzgtOEZCRi1FQjJCMTAwODg0QkMiLCJhdXRoX3RpbWUiOjE3NjUxNzA2MzEsImlkcCI6ImxvY2FsIiwibmFtZSI6IjEzOTg1Njg0NDg2Iiwic2lkIjoiN0ZFODVGQTc0MEU2Q0Q5MTY2MDI4NkRDM0E1MUM3N0EiLCJpYXQiOjE3NjUxNzA2NDIsInNjb3BlIjpbIm9wZW5pZCIsInByb2ZpbGUiLCJjbmFicyIsInF1b3RlcyIsIm9yZ2FuaXphdGlvbiIsImlkZW50aXR5IiwiYXBpY2VudGVyIiwicHJvamVjdHMiLCJwcm9kdWN0cyIsImFzc2V0cyIsIm9wZW5kYXRhIl0sImFtciI6WyJwd2QiXX0.Ayf1hF4bnjukafLLj8uuPxVKwdGnh38embUwne-KpgWJh9Cbp6LtogsMHhpah28C1q31DJ10fO3obxYVMQaGnPKPG3GrRfVOTxw_zkt98fexzGgUALLPAZVtBKV1zCz5Qu3UJx6v4wbFVGxzxgu8XLtS3Wt0HzJs8IDcYN9Guloeo2WZ3C6S69W0uLW5tDlkuC7sIj16uxIMcU2U_9RYv9_yM6yuxDQCVGw-uqa-yQlGiVIemfMrBHJfekFkNeG1XMs9AH9z-7Afd0c0JNTI3LPYHX9DjKA9aPRaEwcIygdQpAzVPuLi5CZihdRL4eJa-aelGm30tiD4-HK4rQRPENh8K4fhWv4cIVKZqxhKtfO_AuVQtaHEHD05SS3i-kkNbz7Dfg4yeB63KeHRs89kYXj8DJmXKtCxiMyP7L7NsLPwFWaR3wxVbAiUfEo6yyDBHhjf0T_0rpg45sGtbAdHPeC2I1npTPNkKhdEmziVw67Z049KciN2-9PKiLmqu-3eGSUnR3hNm8yPuOgY_oVNQyZ9yTqXZ1mTrI2jk-aNjb4s7LGpWasy7FbVE7paGP4_ABkrv2kNJjRjjnpviWtSUD2X-xa8NtuZPo_fffanIU0Ios3STsui2Emupu28pYshDXG-e2aNmnTSERsDFlwhHc4i1Zw9NbuS-Rz2vFBP4pY
Connection: keep-alive
Content-Length: 0
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Cookie: CNABS_PassCode=13985684486; CNABS_PassCode=13985684486; cnabs=C705C3B4DA4CD916B751F47A68621B4B73563ACA71FC49A70E34971E8456555C67F7D1A2B456A75665ABC0F663B76E440E93F476E08BDB1B5FB2514C86107726DFECA6D8DFBCAB31389360643139063F610610F1; cnabs_web=SgS6RPVPU3UNPt6_EEz9S9HzfyPsXVrUW82Gr4GDznJpiqs-qCwYJE_xN7A3j-5unlL5DBhk-8KGvaf01yNoNwEHyj6TLTekZdf-SdsChQN98Rd2bPhVHnMxRgolaRz9ij5plFRTcU9LZPDERi6eyPRt1GmNo64HgsDg5Dnu5dOfpl9FjU7Gj-2hBs29-7l2hY96V-p66olqPJAJnL_C4eYvvaPHljAqHZyfFACXZeSd33oVyd9Ufos0jnRNRENA2jeDcTF4sYI26W29V7VFPlJTmdcVB43zt_tieAZzwcZ4q91fvXFfj1kv9A5AWNNjbHKpc1hodVftskiHnqoY1kfBT3c
Host: www.cn-abs.com
Origin: https://www.cn-abs.com
Referer: https://www.cn-abs.com/product.html
sec-ch-ua: "Not_A Brand";v="99", "Google Chrome";v="109", "Chromium";v="109"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Title: %E4%BA%A7%E5%93%81%E8%AF%81%E5%88%B8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36

å“åº”ï¼š
{"status":"ok","code":200,"data":{"rating_column_name":"è”åˆèµ„ä¿¡","ref_market_interest_type":"ä¸­æœŸç¥¨æ®","note_list":[{"note_detail":{"deal_id":21363,"note_id":56473,"security_name":"25å¼—è¿ªç§ŸèµABN001ä¼˜å…ˆ(ç»¿è‰²)","security_code":"082580899.IB","description":"A","security_type":"ä¼˜å…ˆçº§","notional":6127000000.0,"principal":6127000000.0,"coupon":0.017,"refer_coupon":0.023003933,"refer_interest":-0.0060039329999999995,"current_coupon":0.017,"current_refer_coupon":0.023003933,"current_refer_interest":-0.0060039329999999995,"repayment_of_principal":"è¿‡æ‰‹","coupon_type":"å›ºå®š","rating_pause":"AAA","is_fixed_coupon":true,"base_coupon":null,"base_interest":null,"base_coupon_description":"","issuing_coupon_range":"","principal_pct":0.90315448113207553,"current_rating_pause":"AAA","clean_price":null,"dirty_price":null,"notional_pct":0.90315448113207553,"is_equity":false,"cdr":null,"principal_coverage":null,"interest_coverage":null,"expected_maturity_date":"2028-07-14","settlement_date":null,"remaining_principal_amount":1.0,"expected_rate_securities":null,"frequency_chinese":"å­£ä»˜","initial_wal_legal":null,"current_wal":null,"expected_life":2.7417808219178084,"current_life":"2.5998","coupon_str":"1.7%","current_coupon_str":"1.7%","notional_str":"612,700.00","notional_pct_str":"90.32%","principal_str":"612,700.00","principal_pct_str":"90.32%","refer_interest_str":"-0.6%","current_refer_interest_str":"-0.6%"},"ratings":[{"rating_date":"åˆå§‹è¯„çº§","rating":"AAA","rating_agency":"è”åˆèµ„ä¿¡","rating_agency_fullname":"è”åˆèµ„ä¿¡è¯„ä¼°æœ‰é™å…¬å¸","is_original_rating":true}],"payment_history":[]},{"note_detail":{"deal_id":21363,"note_id":56474,"security_name":"25å¼—è¿ªç§ŸèµABN001æ¬¡çº§(ç»¿è‰²)","security_code":"082580900.IB","description":"Sub","security_type":"æ¬¡çº§","notional":657000000.0,"principal":657000000.0,"coupon":0.04,"refer_coupon":null,"refer_interest":null,"current_coupon":0.04,"current_refer_coupon":null,"current_refer_interest":null,"repayment_of_principal":"è¿‡æ‰‹","coupon_type":null,"rating_pause":"NR","is_fixed_coupon":true,"base_coupon":null,"base_interest":null,"base_coupon_description":"","issuing_coupon_range":"","principal_pct":0.096845518867924529,"current_rating_pause":"NR","clean_price":null,"dirty_price":null,"notional_pct":0.096845518867924529,"is_equity":true,"cdr":null,"principal_coverage":null,"interest_coverage":null,"expected_maturity_date":"2030-07-12","settlement_date":null,"remaining_principal_amount":1.0,"expected_rate_securities":null,"frequency_chinese":"å­£ä»˜","initial_wal_legal":null,"current_wal":null,"expected_life":4.7363013698630141,"current_life":"4.5943","coupon_str":"4%","current_coupon_str":"4%","notional_str":"65,700.00","notional_pct_str":"9.68%","principal_str":"65,700.00","principal_pct_str":"9.68%","refer_interest_str":"--","current_refer_interest_str":"--"},"ratings":[{"rating_date":"åˆå§‹è¯„çº§","rating":"NR","rating_agency":"è”åˆèµ„ä¿¡","rating_agency_fullname":"è”åˆèµ„ä¿¡è¯„ä¼°æœ‰é™å…¬å¸","is_original_rating":true}],"payment_history":[]}]}}


æ­¥éª¤4: è·å–è¯åˆ¸ä¿¡æ¯
    - åœ¨äº§å“é¡µé¢å·¦ä¾§å¯¼èˆªæ ï¼Œç‚¹å‡»"äº§å“è¯åˆ¸"æ ç›®
    - å³ä¾§æ˜¾ç¤ºè¯åˆ¸ä¿¡æ¯
    - é¡¶éƒ¨æœ‰å„è¯åˆ¸çš„æ ‡ç­¾ï¼ˆå¦‚æœæœ‰4ä¸ªè¯åˆ¸ï¼Œå°±æœ‰4ä¸ªæ ‡ç­¾ï¼‰
    - ç‚¹å‡»æ¯ä¸ªæ ‡ç­¾ï¼Œè·å–ä¸‹æ–¹"äº§å“è¯åˆ¸"è¡¨æ ¼ä¸­çš„æ•°æ®

å¤‡æ³¨ï¼šä¼¼ä¹ä¸ç”¨ç‚¹å‡»è¿™äº›æ ‡ç­¾äº†ï¼Œå„è¯åˆ¸æ•°æ®ä¼¼ä¹å·²ç»åœ¨https://www.cn-abs.com/apigateway/cnabs/deal/security-detail?deal_id=21363&page_index=1è¯·æ±‚çš„è¿”å›æ•°æ®ä¸­æä¾›

================================================================================
éœ€è¦æŠ“å–çš„å­—æ®µï¼ˆäº§å“è¯åˆ¸è¡¨æ ¼ï¼‰
================================================================================

    | å­—æ®µåç§°         | è¯´æ˜                    |
    |-----------------|------------------------|
    | è¯åˆ¸åç§°         | è¯åˆ¸çš„å…¨ç§°              |
    | è¯åˆ¸ä»£ç          | è¯åˆ¸çš„å”¯ä¸€æ ‡è¯†ç          |
    | å‘è¡Œé‡           | å‘è¡Œçš„æ€»é‡              |
    | è¿˜æœ¬æ–¹å¼         | æœ¬é‡‘å¿è¿˜æ–¹å¼            |
    | ç±»å‹            | è¯åˆ¸ç±»å‹ï¼ˆä¼˜å…ˆçº§/æ¬¡çº§ç­‰ï¼‰  |
    | å‘è¡Œåˆ©ç‡         | åˆå§‹å‘è¡Œæ—¶çš„åˆ©ç‡         |
    | å½“å‰åˆ©ç‡         | å½“å‰æ‰§è¡Œçš„åˆ©ç‡           |
    | é¢„è®¡åˆ°æœŸæ—¥       | é¢„è®¡çš„åˆ°æœŸæ—¥æœŸ           |
    | è”åˆèµ„ä¿¡(åŸå§‹)
    | è”åˆèµ„ä¿¡(å½“å‰)

å°†æŠ“å–åˆ°çš„è¯åˆ¸ä¿¡æ¯ï¼ŒåŠ ä¸Šâ€œäº§å“å…¨ç§°â€å­—æ®µï¼ˆæ”¾åœ¨ç¬¬0åˆ—ï¼‰ï¼Œå†™å…¥åˆ°ä¸€ä¸ªexcelæ–‡ä»¶
ï¼ˆå¦‚æœæŸäº§å“æœ‰3ä¸ªè¯åˆ¸ï¼Œé‚£ä¹ˆè¯¥äº§å“åœ¨excelä¸­æœ‰ä¸‰è¡Œï¼‰

================================================================================
æŠ€æœ¯å®ç°è¯´æ˜
================================================================================

ç”±äºæ— æ³•ç›´æ¥è®¿é—®ç½‘ç«™ï¼Œæœ¬è„šæœ¬é‡‡ç”¨æ¢ç´¢å¼æ–¹æ³•ï¼š
1. å°è¯•å¤šä¸ªå¸¸è§çš„APIè·¯å¾„æ ¼å¼
2. è®°å½•æ‰€æœ‰è¯·æ±‚å’Œå“åº”
3. åˆ†æé¡µé¢æºç æŸ¥æ‰¾APIçº¿ç´¢
4. æ ¹æ®å®é™…å“åº”è°ƒæ•´çˆ¬å–é€»è¾‘

è¿è¡Œæœ¬è„šæœ¬åï¼Œè¯·å°†æ—¥å¿—å‘é€ç»™å¼€å‘äººå‘˜åˆ†æï¼Œä»¥ç¡®å®šï¼š
- æ­£ç¡®çš„ç™»å½•æ¥å£å’Œå‚æ•°æ ¼å¼
- æœç´¢APIçš„è·¯å¾„å’Œå‚æ•°
- äº§å“è¯¦æƒ…å’Œè¯åˆ¸æ•°æ®çš„APIè·¯å¾„

================================================================================
"""

import requests
import json
import time
import sys
import os
import pandas as pd
from datetime import datetime
from urllib.parse import quote, urlencode

# ==================== é…ç½® ====================
CNABS_USERNAME = "18085157187"
CNABS_PASSWORD = "Password01"
BASE_URL = "https://www.cn-abs.com"
ACCOUNT_URL = "https://account.cn-abs.com"

# APIæ¥å£ï¼ˆæ ¹æ®å®é™…è§‚å¯Ÿï¼‰
API_SEARCH = f"{BASE_URL}/apigateway/cnabs/global/search/pager"
API_SECURITY_DETAIL = f"{BASE_URL}/apigateway/cnabs/deal/security-detail"

# ç™»å½•ç›¸å…³APIï¼ˆaccount.cn-abs.comï¼‰
LOGIN_PAGE_URL = "https://account.cn-abs.com/account.html"
# éªŒè¯ç æ¥å£ï¼šGETè¯·æ±‚ï¼Œè¿”å›image/pngï¼ŒéªŒè¯ç keyé€šè¿‡Set-Cookie: CNABS3_Vcode_Loginè¿”å›
API_CAPTCHA = f"{ACCOUNT_URL}/api/global/captcha"
API_LOGIN = f"{ACCOUNT_URL}/api/account/login"  # ç™»å½•æ¥å£ï¼ˆéœ€è¦è§‚å¯Ÿï¼‰

# è¾“å‡ºæ–‡ä»¶
OUTPUT_EXCEL = "cnabs_securities.xlsx"
SUCCESS_LOG = "successful_products.log"

# è¯·æ±‚å¤´ï¼ˆä¸è®¾ç½®å›ºå®šContent-Typeï¼Œè®©requestsæ ¹æ®data/jsonå‚æ•°è‡ªåŠ¨è®¾ç½®ï¼‰
DEFAULT_HEADERS = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36",
    "Accept": "application/json",
    "Accept-Language": "zh-CN,zh;q=0.9",
    "Accept-Encoding": "gzip, deflate, br",
    "Connection": "keep-alive",
    "Origin": BASE_URL,
    "Referer": f"{BASE_URL}/index.html",
}


class CNABSClient:
    """cn-abs.com å®¢æˆ·ç«¯ - åŸºäºå®é™…APIè§‚å¯Ÿ"""
    
    def __init__(self, username, password):
        self.username = username
        self.password = password
        self.session = requests.Session()
        self.session.headers.update(DEFAULT_HEADERS)
        self.token = None
        self.is_logged_in = False
    
    def _log(self, message, level="INFO"):
        """æ‰“å°æ—¥å¿—"""
        print(f"[{level}] {message}")
    
    def login_with_captcha(self):
        """
        ç™»å½•æµç¨‹ï¼ˆéœ€è¦äººå·¥è¾“å…¥éªŒè¯ç ï¼‰
        
        ç™»å½•é¡µé¢: https://account.cn-abs.com/account.html
        é¡µé¢å…ƒç´ :
        - ç”¨æˆ·åè¾“å…¥æ¡†: class="ant-input ant-input-lg"
        - å¯†ç è¾“å…¥æ¡†: class="ant-input ant-input-lg"
        - éªŒè¯ç å›¾ç‰‡: class="abs-captcha-code-img"
        - éªŒè¯ç è¾“å…¥æ¡†: class="ant-input ant-input-lg"
        - ç”¨æˆ·åè®®å‹¾é€‰: class="ant-checkbox-input"
        - ç™»å½•æŒ‰é’®: type="submit" class="ant-btn ant-btn-primary"
        """
        self._log("=" * 60)
        self._log("å¼€å§‹ç™»å½•æµç¨‹")
        self._log("=" * 60)
        
        # æ­¥éª¤1: è®¿é—®ç™»å½•é¡µé¢ï¼Œè·å–åˆå§‹Cookie
        self._log("æ­¥éª¤1: è®¿é—®ç™»å½•é¡µé¢...")
        response, _ = self._request("GET", LOGIN_PAGE_URL)
        if not response or response.status_code != 200:
            self._log("âœ— æ— æ³•è®¿é—®ç™»å½•é¡µé¢", "ERROR")
            return False
        
        # æ­¥éª¤2: è·å–éªŒè¯ç å›¾ç‰‡
        self._log("æ­¥éª¤2: è·å–éªŒè¯ç ...")
        captcha_path, captcha_key = self._get_captcha()
        
        if not captcha_path:
            self._log("âœ— æ— æ³•è·å–éªŒè¯ç ", "ERROR")
            return False
        
        # æ­¥éª¤3: äººå·¥è¾“å…¥éªŒè¯ç 
        print("\n" + "=" * 60)
        print(f"ğŸ“· éªŒè¯ç å›¾ç‰‡å·²ä¿å­˜åˆ°: {captcha_path}")
        print("è¯·æ‰“å¼€å›¾ç‰‡æŸ¥çœ‹éªŒè¯ç ï¼Œç„¶ååœ¨æ­¤è¾“å…¥")
        print("=" * 60)
        captcha_code = input("è¯·è¾“å…¥éªŒè¯ç : ").strip()
        
        if not captcha_code:
            self._log("âœ— æœªè¾“å…¥éªŒè¯ç ", "ERROR")
            return False
        
        # æ­¥éª¤4: æäº¤ç™»å½•
        self._log("æ­¥éª¤4: æäº¤ç™»å½•...")
        success = self._submit_login(captcha_code, captcha_key)
        
        if not success:
            self._log("âœ— ç™»å½•å¤±è´¥", "ERROR")
            return False
        
        self._log("âœ“ ç™»å½•æˆåŠŸ!")
        
        # æ­¥éª¤5: å®ŒæˆOAuthå›è°ƒï¼ŒåŒæ­¥ç™»å½•çŠ¶æ€åˆ° www.cn-abs.com
        self._log("æ­¥éª¤5: åŒæ­¥ç™»å½•çŠ¶æ€åˆ°ä¸»ç«™...")
        if self._complete_oauth_callback():
            self._log("âœ“ ç™»å½•çŠ¶æ€åŒæ­¥æˆåŠŸ!")
            self.is_logged_in = True
            return True
        else:
            self._log("âš ï¸ OAuthå›è°ƒå¤±è´¥ï¼Œå°è¯•ç»§ç»­...", "WARN")
            self.is_logged_in = True  # ä»ç„¶æ ‡è®°ä¸ºå·²ç™»å½•ï¼Œå°è¯•ç»§ç»­
            return True
    
    def _complete_oauth_callback(self):
        """
        å®ŒæˆOAuthå›è°ƒï¼Œå°†ç™»å½•çŠ¶æ€åŒæ­¥åˆ° www.cn-abs.com
        
        æµç¨‹ï¼š
        1. è®¿é—® /connect/authorize/callback è·å–302é‡å®šå‘
        2. ä»Locationå¤´ä¸­æå–access_token
        3. è®¾ç½®Authorization: Bearer xxx è¯·æ±‚å¤´
        
        æ³¨æ„ï¼šstateå’Œnonceéœ€è¦ä¸ç™»å½•é¡µé¢URLä¸­çš„ä¸€è‡´
        """
        import uuid
        import re
        
        # ç”Ÿæˆstateå’Œnonceï¼ˆæœåŠ¡å™¨ä¼šéªŒè¯ï¼Œä½†ç™»å½•æˆåŠŸååº”è¯¥æ¥å—æ–°çš„ï¼‰
        state = uuid.uuid4().hex
        nonce = uuid.uuid4().hex
        
        # OAuthæˆæƒURLï¼ˆä¸æµè§ˆå™¨è§‚å¯Ÿåˆ°çš„ä¸€è‡´ï¼‰
        authorize_url = (
            f"{ACCOUNT_URL}/connect/authorize/callback"
            f"?clientid=js_oauth"
            f"&client_id=js_oauth"
            f"&redirecturi=https%3A%2F%2Fwww.cn-abs.com%2Fsign.html%23%2Fcallback%3F"
            f"&redirect_uri=https%3A%2F%2Fwww.cn-abs.com%2Fsign.html%23%2Fcallback%3F"
            f"&responsetype=id_token%20token"
            f"&response_type=id_token%20token"
            f"&scope=openid%20profile%20cnabs%20quotes%20organization%20identity%20apicenter%20projects%20products%20assets%20opendata"
            f"&state={state}"
            f"&nonce={nonce}"
        )
        
        self._log(f"è®¿é—®OAuthæˆæƒURL...")
        
        try:
            # è®¿é—®æˆæƒURLï¼Œä¼šè¿”å›302é‡å®šå‘åˆ°å›è°ƒURLï¼ˆå¸¦tokenï¼‰
            response = self.session.get(authorize_url, allow_redirects=False, timeout=30)
            self._log(f"å“åº”çŠ¶æ€: {response.status_code}")
            
            if response.status_code == 302:
                # è·å–é‡å®šå‘URL
                redirect_url = response.headers.get("Location", "")
                self._log(f"é‡å®šå‘åˆ°: {redirect_url[:100]}...")
                
                # ä»é‡å®šå‘URLä¸­æå–access_token
                if "access_token=" in redirect_url:
                    token_match = re.search(r'access_token=([^&]+)', redirect_url)
                    if token_match:
                        self.token = token_match.group(1)
                        self._log(f"âœ“ è·å–åˆ°access_token (é•¿åº¦: {len(self.token)})")
                        
                        # è®¾ç½®Authorizationå¤´
                        self.session.headers["Authorization"] = f"Bearer {self.token}"
                        
                        # è°ƒç”¨login/oauth APIè·å–cnabså’Œcnabs_web Cookie
                        self._log("è°ƒç”¨login/oauthè·å–Cookie...")
                        try:
                            oauth_url = f"{BASE_URL}/apigateway/cnabs/account/login/oauth"
                            oauth_headers = {
                                "Accept": "application/json",
                                "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
                                "Content-Length": "0",
                                "Origin": BASE_URL,
                                "Referer": f"{BASE_URL}/sign.html",
                            }
                            oauth_resp = self.session.post(oauth_url, headers=oauth_headers, data="", timeout=30)
                            self._log(f"login/oauthå“åº”: {oauth_resp.status_code}")
                            
                            # æ‰“å°å½“å‰æ‰€æœ‰Cookie
                            cookies = [c.name for c in self.session.cookies]
                            self._log(f"å½“å‰Cookies: {cookies}")
                            
                            # éªŒè¯æ˜¯å¦è·å–åˆ°cnabs Cookie
                            if 'cnabs' in cookies and 'cnabs_web' in cookies:
                                self._log("âœ“ æˆåŠŸè·å–cnabså’Œcnabs_web Cookie!")
                            else:
                                self._log("âš  æœªè·å–åˆ°cnabs Cookie", "WARN")
                        except Exception as e:
                            self._log(f"login/oauthå¤±è´¥: {e}", "WARN")
                        
                        return True
                else:
                    self._log(f"é‡å®šå‘URLä¸­æ²¡æœ‰access_token", "WARN")
            
            # å¦‚æœä¸æ˜¯302ï¼Œæ‰“å°æ›´å¤šä¿¡æ¯
            self._log(f"å“åº”å¤´: {dict(response.headers)}")
            if response.text:
                self._log(f"å“åº”å†…å®¹: {response.text[:500]}")
                        
        except Exception as e:
            self._log(f"OAuthå›è°ƒå¤±è´¥: {e}", "ERROR")
        
        return False
    
    def _get_captcha(self):
        """
        è·å–éªŒè¯ç å›¾ç‰‡
        
        æ¥å£: GET https://account.cn-abs.com/api/global/captcha?type=Login&t=éšæœºæ•°
        è¿”å›: image/png å›¾ç‰‡
        éªŒè¯ç Key: é€šè¿‡ Set-Cookie: CNABS3_Vcode_Login=xxx è¿”å›
        """
        import random
        
        # æ„å»ºéªŒè¯ç URLï¼ˆå¸¦éšæœºæ•°é˜²ç¼“å­˜ï¼‰
        t = random.random()
        url = f"{API_CAPTCHA}?type=Login&t={t}"
        
        self._log(f"è·å–éªŒè¯ç : {url}")
        
        try:
            response = self.session.get(url, timeout=30)
            
            if response.status_code == 200:
                content_type = response.headers.get("Content-Type", "")
                
                if "image" in content_type:
                    # ä¿å­˜éªŒè¯ç å›¾ç‰‡
                    captcha_path = "captcha.png"
                    with open(captcha_path, "wb") as f:
                        f.write(response.content)
                    self._log(f"âœ“ éªŒè¯ç å›¾ç‰‡å·²ä¿å­˜: {captcha_path}")
                    
                    # éªŒè¯ç Keyä»Cookieè·å–: CNABS3_Vcode_Login
                    captcha_key = self.session.cookies.get("CNABS3_Vcode_Login")
                    self._log(f"éªŒè¯ç Key (CNABS3_Vcode_Login): {captcha_key}")
                    
                    return captcha_path, captcha_key
                else:
                    self._log(f"âœ— è¿”å›ç±»å‹ä¸æ˜¯å›¾ç‰‡: {content_type}", "ERROR")
            else:
                self._log(f"âœ— è¯·æ±‚å¤±è´¥: {response.status_code}", "ERROR")
                
        except Exception as e:
            self._log(f"è·å–éªŒè¯ç å¤±è´¥: {e}", "ERROR")
        
        return None, None
    
    def _submit_login(self, captcha_code, captcha_key=None):
        """
        æäº¤ç™»å½•è¯·æ±‚
        
        æ¥å£: POST https://account.cn-abs.com/api/account/login
        è½½è·: {"user_name": "xxx", "password": "xxx", "captcha": "xxxx"}
        æˆåŠŸæ ‡å¿—: Set-Cookie åŒ…å« idsrv.session å’Œ .AspNetCore.Identity.Application
        """
        url = f"{ACCOUNT_URL}/api/account/login"
        
        login_data = {
            "user_name": self.username,
            "password": self.password,
            "captcha": captcha_code
        }
        
        self._log(f"æäº¤ç™»å½•: {url}")
        self._log(f"è½½è·: user_name={self.username}, captcha={captcha_code}")
        
        try:
            response = self.session.post(url, json=login_data, timeout=30)
            self._log(f"å“åº”çŠ¶æ€: {response.status_code}")
            
            # æ‰“å°å“åº”å†…å®¹ï¼ˆè°ƒè¯•ç”¨ï¼‰
            try:
                resp_data = response.json()
                self._log(f"å“åº”å†…å®¹: {resp_data}")
            except:
                self._log(f"å“åº”æ–‡æœ¬: {response.text[:200]}")
            
            # æ£€æŸ¥ç™»å½•æ˜¯å¦æˆåŠŸ
            if self._check_login_response(response):
                return True
            else:
                self._log("âœ— ç™»å½•éªŒè¯å¤±è´¥", "ERROR")
                return False
                
        except Exception as e:
            self._log(f"ç™»å½•è¯·æ±‚å¤±è´¥: {e}", "ERROR")
            return False
    
    def _check_login_response(self, response):
        """
        æ£€æŸ¥ç™»å½•å“åº”æ˜¯å¦æˆåŠŸ
        
        æˆåŠŸæ ‡å¿—: 
        1. Set-Cookie åŒ…å« idsrv.session
        2. Set-Cookie åŒ…å« .AspNetCore.Identity.Application
        """
        if not response or response.status_code != 200:
            return False
        
        # æ£€æŸ¥æ˜¯å¦æœ‰ç™»å½•æˆåŠŸçš„Cookie
        cookies = self.session.cookies.get_dict()
        self._log(f"å½“å‰Cookies: {list(cookies.keys())}")
        
        # æ£€æŸ¥å…³é”®Cookie
        has_idsrv = "idsrv.session" in cookies or "idsrv" in str(cookies)
        has_aspnet = ".AspNetCore.Identity.Application" in cookies
        
        if has_idsrv or has_aspnet:
            self._log("âœ“ æ£€æµ‹åˆ°ç™»å½•æˆåŠŸCookie")
            return True
        
        # ä¹Ÿæ£€æŸ¥å“åº”JSON
        try:
            data = response.json()
            if data.get("code") in [0, 200, "0", "200"]:
                return True
            if data.get("success") == True:
                return True
        except:
            pass
        
        return False
    
    def _request(self, method, url, **kwargs):
        """å‘é€è¯·æ±‚å¹¶æ‰“å°è°ƒè¯•ä¿¡æ¯"""
        self._log(f"è¯·æ±‚: {method} {url}")
        if 'json' in kwargs:
            self._log(f"è¯·æ±‚ä½“: {json.dumps(kwargs['json'], ensure_ascii=False)[:300]}")
        
        # æ‰“å°å…³é”®è¯·æ±‚å¤´
        auth_header = self.session.headers.get("Authorization", "æ— ")
        self._log(f"Authorization: {auth_header[:80]}..." if len(auth_header) > 80 else f"Authorization: {auth_header}")
        
        try:
            response = self.session.request(method, url, timeout=30, **kwargs)
            self._log(f"å“åº”çŠ¶æ€: {response.status_code}")
            
            # å°è¯•è§£æJSON
            try:
                data = response.json()
                self._log(f"å“åº”JSON: {json.dumps(data, ensure_ascii=False)[:500]}...")
                return response, data
            except:
                self._log(f"å“åº”æ–‡æœ¬: {response.text[:300]}")
                return response, None
                
        except Exception as e:
            self._log(f"è¯·æ±‚å¤±è´¥: {e}", "ERROR")
            return None, None
    
    def search_product(self, keyword):
        """
        æœç´¢äº§å“
        API: POST https://www.cn-abs.com/apigateway/cnabs/global/search/pager
        Content-Type: application/x-www-form-urlencoded (ä¸æ˜¯JSON!)
        """
        self._log("=" * 60)
        self._log(f"æœç´¢äº§å“: {keyword}")
        self._log("=" * 60)
        
        # æ³¨æ„ï¼šæµè§ˆå™¨ä½¿ç”¨çš„æ˜¯ form-urlencoded æ ¼å¼ï¼Œä¸æ˜¯ JSON
        payload = {
            "keyword": keyword,
            "search_type": 0,
            "timestamp": datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%S.%f")[:-3] + "Z",
            "page_index": 1,
            "page_size": 30
        }
        
        # ä½¿ç”¨ data= è€Œä¸æ˜¯ json=ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨ä½¿ç”¨ form-urlencoded
        response, data = self._request("POST", API_SEARCH, data=payload)
        
        if response and response.status_code == 200 and data:
            if data.get("code") == 200 and data.get("status") == "ok":
                self._log("âœ“ æœç´¢æˆåŠŸ!")
                return data.get("data")
        
        self._log("âœ— æœç´¢å¤±è´¥", "ERROR")
        return None
    
    def get_security_detail(self, deal_id, page_index=1):
        """
        è·å–äº§å“è¯åˆ¸è¯¦æƒ…
        API: POST https://www.cn-abs.com/apigateway/cnabs/deal/security-detail?deal_id=XXX&page_index=1
        
        å…³é”®ï¼šContent-Length: 0ï¼Œå‚æ•°åœ¨URLä¸­ï¼Œè¯·æ±‚ä½“ä¸ºç©ºï¼
        """
        self._log("=" * 60)
        self._log(f"è·å–è¯åˆ¸è¯¦æƒ…: deal_id={deal_id}")
        self._log("=" * 60)
        
        # å…ˆè°ƒç”¨ check æ¥å£ï¼ˆæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼‰
        check_url = f"{BASE_URL}/apigateway/cnabs/account/invite/business/check"
        check_params = {
            "url": f"/product.html/#/detail/security?deal_id={deal_id}",
            "title": "äº§å“è¯åˆ¸"
        }
        try:
            self.session.post(check_url, params=check_params, timeout=10)
        except:
            pass  # å¿½ç•¥checkè¯·æ±‚çš„é”™è¯¯
        
        # è·å–è¯åˆ¸è¯¦æƒ… - å‚æ•°åœ¨URLä¸­ï¼Œè¯·æ±‚ä½“ä¸ºç©º
        url = f"{API_SECURITY_DETAIL}?deal_id={deal_id}&page_index={page_index}"
        
        # æ‰“å°å½“å‰Cookieï¼ˆè°ƒè¯•ï¼‰
        cookies = [c.name for c in self.session.cookies]
        self._log(f"å½“å‰Cookies: {cookies}")
        
        # POSTè¯·æ±‚ï¼Œä½†è¯·æ±‚ä½“ä¸ºç©ºï¼ˆContent-Length: 0ï¼‰
        response, data = self._request("POST", url)
        
        if response and response.status_code == 200 and data:
            if data.get("code") == 200 and data.get("status") == "ok":
                self._log("âœ“ è·å–è¯åˆ¸è¯¦æƒ…æˆåŠŸ!")
                return data.get("data")
        
        self._log("âœ— è·å–è¯åˆ¸è¯¦æƒ…å¤±è´¥", "ERROR")
        return None
    
    def parse_security_info(self, security_data):
        """
        è§£æè¯åˆ¸ä¿¡æ¯ï¼Œæå–éœ€è¦çš„å­—æ®µ
        
        è¿”å›å­—æ®µæ˜ å°„ï¼š
        - security_name -> è¯åˆ¸åç§°
        - security_code -> è¯åˆ¸ä»£ç 
        - notional -> å‘è¡Œé‡
        - repayment_of_principal -> è¿˜æœ¬æ–¹å¼
        - security_type -> ç±»å‹
        - coupon -> å‘è¡Œåˆ©ç‡
        - current_coupon -> å½“å‰åˆ©ç‡
        - expected_maturity_date -> é¢„è®¡åˆ°æœŸæ—¥
        - rating_pause -> è¯„çº§ï¼ˆåŸå§‹ï¼‰
        - current_rating_pause -> è¯„çº§ï¼ˆå½“å‰ï¼‰
        """
        if not security_data:
            return []
        
        results = []
        note_list = security_data.get("note_list", [])
        rating_agency = security_data.get("rating_column_name", "æœªçŸ¥è¯„çº§æœºæ„")
        
        for note in note_list:
            detail = note.get("note_detail", {})
            ratings = note.get("ratings", [])
            
            # è·å–åŸå§‹è¯„çº§
            original_rating = "N/A"
            current_rating = detail.get("current_rating_pause", "N/A")
            for r in ratings:
                if r.get("is_original_rating"):
                    original_rating = r.get("rating", "N/A")
                    break
            
            security_info = {
                "è¯åˆ¸åç§°": detail.get("security_name", ""),
                "è¯åˆ¸ä»£ç ": detail.get("security_code", ""),
                "å‘è¡Œé‡": detail.get("notional", 0),
                "å‘è¡Œé‡(ä¸‡å…ƒ)": detail.get("notional_str", ""),
                "è¿˜æœ¬æ–¹å¼": detail.get("repayment_of_principal", ""),
                "ç±»å‹": detail.get("security_type", ""),
                "å‘è¡Œåˆ©ç‡": detail.get("coupon", 0),
                "å‘è¡Œåˆ©ç‡(%)": detail.get("coupon_str", ""),
                "å½“å‰åˆ©ç‡": detail.get("current_coupon", 0),
                "å½“å‰åˆ©ç‡(%)": detail.get("current_coupon_str", ""),
                "é¢„è®¡åˆ°æœŸæ—¥": detail.get("expected_maturity_date", ""),
                f"{rating_agency}ï¼ˆåŸå§‹ï¼‰": original_rating,
                f"{rating_agency}ï¼ˆå½“å‰ï¼‰": current_rating,
                # é¢å¤–å­—æ®µ
                "deal_id": detail.get("deal_id"),
                "note_id": detail.get("note_id"),
                "ç¥¨æ¯ç±»å‹": detail.get("coupon_type", ""),
                "ä»˜æ¯é¢‘ç‡": detail.get("frequency_chinese", ""),
            }
            results.append(security_info)
        
        return results
    
    def fetch_product_securities(self, product_name):
        """
        å®Œæ•´æµç¨‹ï¼šæœç´¢äº§å“ -> è·å–deal_id -> è·å–è¯åˆ¸è¯¦æƒ… -> è§£ææ•°æ®
        """
        self._log("=" * 60)
        self._log(f"å¼€å§‹è·å–äº§å“è¯åˆ¸ä¿¡æ¯: {product_name}")
        self._log("=" * 60)
        
        # æ­¥éª¤1: æœç´¢äº§å“
        search_result = self.search_product(product_name)
        if not search_result:
            return None
        
        # ä»æœç´¢ç»“æœä¸­è·å–deal_id
        deal_pager = search_result.get("DealPager", {})
        items = deal_pager.get("items", [])
        
        if not items:
            self._log("âœ— æœªæ‰¾åˆ°åŒ¹é…çš„äº§å“", "ERROR")
            return None
        
        # å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„äº§å“
        product = items[0]
        deal_id = product.get("id")
        product_name_found = product.get("full_name")
        
        self._log(f"æ‰¾åˆ°äº§å“: {product_name_found} (deal_id={deal_id})")
        
        # æ­¥éª¤2: è·å–è¯åˆ¸è¯¦æƒ…
        security_data = self.get_security_detail(deal_id)
        if not security_data:
            return None
        
        # æ­¥éª¤3: è§£æè¯åˆ¸ä¿¡æ¯
        securities = self.parse_security_info(security_data)
        
        return {
            "product": product,
            "securities": securities,
            "raw_data": security_data
        }


def print_securities_table(securities):
    """æ‰“å°è¯åˆ¸ä¿¡æ¯è¡¨æ ¼"""
    if not securities:
        print("æ²¡æœ‰è¯åˆ¸æ•°æ®")
        return
    
    print("\n" + "=" * 100)
    print("äº§å“è¯åˆ¸ä¿¡æ¯")
    print("=" * 100)
    
    for i, sec in enumerate(securities, 1):
        print(f"\n--- è¯åˆ¸ {i} ---")
        for key, value in sec.items():
            if not key.startswith("deal_id") and not key.startswith("note_id"):
                print(f"  {key}: {value}")


def load_successful_products():
    """åŠ è½½å·²æˆåŠŸå¤„ç†çš„äº§å“åˆ—è¡¨"""
    if os.path.exists(SUCCESS_LOG):
        with open(SUCCESS_LOG, "r", encoding="utf-8") as f:
            return set(line.strip() for line in f if line.strip())
    return set()


def save_successful_product(product_name):
    """è®°å½•æˆåŠŸå¤„ç†çš„äº§å“ï¼ˆè¿½åŠ æ¨¡å¼ï¼‰"""
    with open(SUCCESS_LOG, "a", encoding="utf-8") as f:
        f.write(product_name + "\n")


def main(list_product_names, skip_login=False):
    """
    ä¸»å‡½æ•° - æ‰¹é‡æŠ“å–äº§å“è¯åˆ¸ä¿¡æ¯
    
    æµç¨‹ï¼š
    1. ç™»å½•ï¼ˆå¦‚æœéœ€è¦ï¼‰
    2. åˆ›å»ºå®¢æˆ·ç«¯ï¼ˆå¤ç”¨sessionï¼‰
    3. éå†äº§å“åˆ—è¡¨ï¼Œä¾æ¬¡æŠ“å–è¯åˆ¸ä¿¡æ¯
    4. æ¯æˆåŠŸä¸€ä¸ªï¼Œç«‹å³è®°å½•åˆ°logæ–‡ä»¶ï¼ˆæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼‰
    5. æœ€åå°†æ‰€æœ‰ç»“æœå†™å…¥Excel
    """
    print("=" * 80)
    print("cn-abs.com è¯åˆ¸ä¿¡æ¯æ‰¹é‡æŠ“å–")
    print("=" * 80)
    print(f"å¾…å¤„ç†äº§å“æ•°: {len(list_product_names)}")
    print(f"è¾“å‡ºæ–‡ä»¶: {OUTPUT_EXCEL}")
    print(f"æˆåŠŸæ—¥å¿—: {SUCCESS_LOG}")
    print("=" * 80)
    
    # åˆ›å»ºå®¢æˆ·ç«¯ï¼ˆå¾ªç¯å¤–åˆ›å»ºï¼Œå¤ç”¨sessionï¼‰
    client = CNABSClient(CNABS_USERNAME, CNABS_PASSWORD)
    
    # ç™»å½•æµç¨‹
    if not skip_login:
        print("\n" + "=" * 80)
        print("ç™»å½•é€‰é¡¹:")
        print("1. äººå·¥è¾“å…¥éªŒè¯ç ç™»å½•")
        print("2. è·³è¿‡ç™»å½•ï¼ˆå…ˆæµ‹è¯•APIæ˜¯å¦å…¬å¼€ï¼‰")
        print("=" * 80)
        choice = input("è¯·é€‰æ‹© (1/2): ").strip()
        
        if choice == "1":
            if not client.login_with_captcha():
                print("\nâš ï¸ ç™»å½•å¤±è´¥ï¼")
                retry = input("æ˜¯å¦ç»§ç»­å°è¯•ä¸ç™»å½•æŠ“å–ï¼Ÿ(y/n): ").strip().lower()
                if retry != 'y':
                    print("é€€å‡ºç¨‹åº")
                    return
        else:
            print("\nè·³è¿‡ç™»å½•ï¼Œç›´æ¥å°è¯•æŠ“å–...")
    
    # åˆå§‹åŒ–ç»“æœåˆ—è¡¨
    all_results = []
    success_count = 0
    fail_count = 0
    
    # éå†äº§å“åˆ—è¡¨
    for i, product_name in enumerate(list_product_names, 1):
        print(f"\n[{i}/{len(list_product_names)}] å¤„ç†: {product_name}")
        
        try:
            # è·å–äº§å“è¯åˆ¸ä¿¡æ¯
            result = client.fetch_product_securities(product_name)
            
            if result and result.get("securities"):
                # æ‰“å°äº§å“ä¿¡æ¯
                product = result["product"]
                print(f"  âœ“ æ‰¾åˆ°äº§å“: {product.get('short_name')}")
                print(f"    è¯åˆ¸æ•°é‡: {len(result['securities'])}")
                
                # å°†æ¯ä¸ªè¯åˆ¸æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ï¼Œå¹¶æ·»åŠ äº§å“å…¨ç§°åˆ—
                for sec in result["securities"]:
                    row = {"äº§å“å…¨ç§°": product.get("full_name", product_name)}
                    # æŒ‰æŒ‡å®šé¡ºåºæ·»åŠ å­—æ®µ
                    row["è¯åˆ¸åç§°"] = sec.get("è¯åˆ¸åç§°", "")
                    row["è¯åˆ¸ä»£ç "] = sec.get("è¯åˆ¸ä»£ç ", "")
                    row["å‘è¡Œé‡"] = sec.get("å‘è¡Œé‡", 0)
                    row["å‘è¡Œé‡(ä¸‡å…ƒ)"] = sec.get("å‘è¡Œé‡(ä¸‡å…ƒ)", "")
                    row["è¿˜æœ¬æ–¹å¼"] = sec.get("è¿˜æœ¬æ–¹å¼", "")
                    row["ç±»å‹"] = sec.get("ç±»å‹", "")
                    row["å‘è¡Œåˆ©ç‡"] = sec.get("å‘è¡Œåˆ©ç‡", 0)
                    row["å‘è¡Œåˆ©ç‡(%)"] = sec.get("å‘è¡Œåˆ©ç‡(%)", "")
                    row["å½“å‰åˆ©ç‡"] = sec.get("å½“å‰åˆ©ç‡", 0)
                    row["å½“å‰åˆ©ç‡(%)"] = sec.get("å½“å‰åˆ©ç‡(%)", "")
                    row["é¢„è®¡åˆ°æœŸæ—¥"] = sec.get("é¢„è®¡åˆ°æœŸæ—¥", "")
                    # è¯„çº§å­—æ®µï¼ˆåŠ¨æ€è·å–ï¼‰
                    for key in sec:
                        if "åŸå§‹" in key or "å½“å‰" in key:
                            if key not in row:
                                row[key] = sec[key]
                    all_results.append(row)
                
                # ç«‹å³è®°å½•æˆåŠŸï¼ˆæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼‰
                save_successful_product(product_name)
                success_count += 1
            else:
                print(f"  âœ— æœªæ‰¾åˆ°æ•°æ®")
                fail_count += 1
                
        except Exception as e:
            print(f"  âœ— å¤„ç†å¤±è´¥: {e}")
            fail_count += 1
            continue  # ç»§ç»­ä¸‹ä¸€ä¸ªï¼Œä¸ä¸­æ–­
        
        # è¯·æ±‚é—´éš”ï¼Œé¿å…è¿‡å¿«
        time.sleep(0.5)
    
    # ä¿å­˜ç»“æœåˆ°Excelï¼ˆè¿½åŠ æ¨¡å¼ï¼‰
    print("\n" + "=" * 80)
    print("ä¿å­˜ç»“æœ...")
    print("=" * 80)
    
    if all_results:
        df_new = pd.DataFrame(all_results)
        
        # å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œè¯»å–å¹¶è¿½åŠ 
        if os.path.exists(OUTPUT_EXCEL):
            try:
                df_existing = pd.read_excel(OUTPUT_EXCEL, engine='openpyxl')
                df_results = pd.concat([df_existing, df_new], ignore_index=True)
                print(f"  å·²æœ‰æ•°æ®: {len(df_existing)} è¡Œ")
                print(f"  æ–°å¢æ•°æ®: {len(df_new)} è¡Œ")
            except Exception as e:
                print(f"  âš ï¸ è¯»å–å·²æœ‰æ–‡ä»¶å¤±è´¥: {e}ï¼Œå°†è¦†ç›–å†™å…¥")
                df_results = df_new
        else:
            df_results = df_new
        
        df_results.to_excel(OUTPUT_EXCEL, index=False, engine='openpyxl')
        print(f"âœ“ ç»“æœå·²ä¿å­˜åˆ°: {OUTPUT_EXCEL}")
        print(f"  æ€»è¡Œæ•°: {len(df_results)}")
    else:
        print("âš ï¸ æ²¡æœ‰æ•°æ®å¯ä¿å­˜")
    
    # æ‰“å°ç»Ÿè®¡
    print("\n" + "=" * 80)
    print("å¤„ç†å®Œæˆ!")
    print("=" * 80)
    print(f"æˆåŠŸ: {success_count}")
    print(f"å¤±è´¥: {fail_count}")
    print(f"æ€»è®¡: {len(list_product_names)}")


if __name__ == "__main__":
    # ä½¿ç”¨è¯´æ˜
    if len(sys.argv) < 2:
        print("ä½¿ç”¨æ–¹æ³•: python cnabs_bonds_test.py <excelæ–‡ä»¶è·¯å¾„>")
        print("Excelæ–‡ä»¶è¦æ±‚: ç¬¬ä¸€ä¸ªsheetçš„Aåˆ—åŒ…å«æ‰€æœ‰éœ€è¦æŸ¥è¯¢çš„äº§å“å…¨ç§°")
        print("\nç¤ºä¾‹: python cnabs_bonds_test.py products.xlsx")
        sys.exit(1)
    
    excel_file_path = sys.argv[1]
    
    # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if not os.path.exists(excel_file_path):
        print(f"é”™è¯¯: æ–‡ä»¶ä¸å­˜åœ¨ - {excel_file_path}")
        sys.exit(1)
    
    # è¯»å–Excelæ–‡ä»¶ï¼Œè·å–Aåˆ—çš„äº§å“åç§°
    print(f"è¯»å–Excelæ–‡ä»¶: {excel_file_path}")
    df = pd.read_excel(excel_file_path, sheet_name=0, header=None)
    all_product_names = df.iloc[:, 0].dropna().astype(str).tolist()
    print(f"Excelä¸­å…±æœ‰ {len(all_product_names)} ä¸ªäº§å“")
    
    # è¯»å–å·²æˆåŠŸçš„äº§å“ï¼Œæ’é™¤å®ƒä»¬
    successful_products = load_successful_products()
    if successful_products:
        print(f"å·²æˆåŠŸå¤„ç† {len(successful_products)} ä¸ªäº§å“ï¼Œå°†è·³è¿‡")
    
    list_product_names = [p for p in all_product_names if p not in successful_products]
    print(f"æœ¬æ¬¡éœ€è¦å¤„ç† {len(list_product_names)} ä¸ªäº§å“")
    
    if not list_product_names:
        print("æ‰€æœ‰äº§å“éƒ½å·²å¤„ç†å®Œæˆ!")
        sys.exit(0)
    
    # å¼€å§‹å¤„ç†
    main(list_product_names)
